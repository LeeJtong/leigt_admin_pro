import{d as j,Z as C,r as y,$ as D,g as O,c as b,b as I,e as a,w as t,u as n,H as R,F as N,E as T,a3 as $,a8 as A,o as u,a0 as H,a1 as J,a9 as K,K as v,aa as M,J as E,i as W,j as c,a2 as Z,C as q,_ as G}from"./vendor-npTBgVJn.js";import{b as P,g as Q}from"./common-DPBG_eAh.js";import{g as X}from"./shared/role/user-Cdar6P-q.js";const Y={class:"dialog-footer"},ee=j({__name:"index",setup(le){P();const r=C({nickName:"",role:0});let _=y([]),d=y([]);const i=y(!1);let s=C({id:0,nickName:"",role:[],userName:""});const L=()=>{let o=[];r.nickName||r.role?(r.nickName&&(o=d.value.filter(e=>e.nickName.indexOf(r.nickName)!==-1)),r.role&&(o=r.nickName?o:d.value,o=o.filter(e=>e.role.find(m=>m.role===r.role)))):o=d.value,d.value=o};D([()=>r.nickName,()=>r.role],()=>{(r.nickName===""||r.role===0)&&U()});const h=o=>{i.value=!0,Object.assign(s,{...o,role:o.role.map(e=>e.role)})},B=()=>{console.log(s),i.value=!1;let o=d.value.find(e=>e.id===s.id);o.nickName=s.nickName,o.role=[],console.log(o),_.value.forEach(e=>{s.role.find(m=>m===e.roleId)&&o.role.push({role:e.roleId,roleName:e.roleName})})};O(()=>{U(),S()});const U=()=>{Q().then(o=>{d.value=o.data})},S=()=>{X().then(o=>{_.value=o.data})};return(o,e)=>{const m=J,p=H,V=M,w=K,f=W,x=T,k=Z,z=$,F=A;return u(),b(N,null,[I("div",null,[a(x,{inline:!0,class:"search-form",model:n(r)},{default:t(()=>[a(p,{label:"用户名称"},{default:t(()=>[a(m,{modelValue:n(r).nickName,"onUpdate:modelValue":e[0]||(e[0]=l=>n(r).nickName=l),placeholder:"请输入用户名称"},null,8,["modelValue"])]),_:1}),a(p,{label:"用户角色"},{default:t(()=>[a(w,{modelValue:n(r).role,"onUpdate:modelValue":e[1]||(e[1]=l=>n(r).role=l),class:"m-2",size:"large"},{default:t(()=>[(u(),v(V,{key:0,label:"全部",value:0})),(u(!0),b(N,null,E(n(_),l=>(u(),v(V,{key:l.roleId,label:l.roleName,value:l.roleId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(p,null,{default:t(()=>[a(f,{type:"primary",onClick:L},{default:t(()=>e[6]||(e[6]=[c("查询")])),_:1})]),_:1})]),_:1},8,["model"]),a(z,{data:n(d),border:"",style:{width:"100%"}},{default:t(()=>[a(k,{prop:"id",label:"编号",width:"180"}),a(k,{prop:"nickName",label:"用户昵称",width:"180"}),a(k,{prop:"role",label:"用户角色"},{default:t(l=>[(u(!0),b(N,null,E(l.row.role,g=>(u(),v(f,{key:g.role,link:"",type:"primary",size:"small"},{default:t(()=>[c(q(g.roleName),1)]),_:2},1024))),128))]),_:1}),a(k,{prop:"role",label:"操作"},{default:t(l=>[a(f,{type:"primary",size:"small",onClick:g=>h(l.row)},{default:t(()=>e[7]||(e[7]=[c("编辑")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),a(F,{modelValue:n(i),"onUpdate:modelValue":e[5]||(e[5]=l=>R(i)?i.value=l:null),title:"编辑用户信息"},{footer:t(()=>[I("span",Y,[a(f,{onClick:e[4]||(e[4]=l=>i.value=!1)},{default:t(()=>e[8]||(e[8]=[c("取消")])),_:1}),a(f,{type:"primary",onClick:B},{default:t(()=>e[9]||(e[9]=[c("修改")])),_:1})])]),default:t(()=>[a(x,{model:n(s)},{default:t(()=>[a(p,{label:"用户昵称","label-width":"120px"},{default:t(()=>[a(m,{modelValue:n(s).nickName,"onUpdate:modelValue":e[2]||(e[2]=l=>n(s).nickName=l),class:"w192",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(p,{label:"用户角色","label-width":"120px"},{default:t(()=>[a(w,{modelValue:n(s).role,"onUpdate:modelValue":e[3]||(e[3]=l=>n(s).role=l),multiple:"",class:"m-2",size:"large",placeholder:"请选择角色"},{default:t(()=>[(u(!0),b(N,null,E(n(_),l=>(u(),v(V,{key:l.roleId,label:l.roleName,value:l.roleId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}}),re=G(ee,[["__scopeId","data-v-e3ce6603"]]);export{re as default};
